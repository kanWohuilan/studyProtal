import{k as T,o as l,e as m,i as o,_ as V,a as z,w as I,r as L,c as B,ar as F,N as S,b as G,d as n,n as W,h as s,ak as j,g as i,t as p,am as y,f as E,F as P}from"./entry-21db2f40.mjs";import{u as R,a as U,b as X}from"./order-2a28a7fd.mjs";import{_ as q}from"./Price-f7b39efa.mjs";import{_ as H}from"./Group-1cd53dfb.mjs";import{N as J}from"./Tag-06ce51bd.mjs";import{N as K}from"./Image-ec1fc6fc.mjs";import{N as Q}from"./Icon-8b068cec.mjs";import{N as Y,a as Z}from"./Grid-87bc6c3f.mjs";import"./use-locale-d1b818a5.mjs";import"./utils-4e919375.mjs";import"./Popover-ea85df19.mjs";import"./get-bc1ef6a5.mjs";import"./use-merged-state-aa6f3d5b.mjs";import"./next-frame-once-08317937.mjs";import"./get-slot-f07f150d.mjs";const $={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ee=o("path",{"data-name":"XMLID 501 -1",d:"M408.67 298.53a21 21 0 1 1 20.9-21a20.85 20.85 0 0 1-20.9 21m-102.17 0a21 21 0 1 1 20.9-21a20.84 20.84 0 0 1-20.9 21m152.09 118.86C491.1 394.08 512 359.13 512 319.51c0-71.08-68.5-129.35-154.41-129.35s-154.42 58.27-154.42 129.35s68.5 129.34 154.42 129.34c17.41 0 34.83-2.33 49.92-7c2.49-.86 3.48-1.17 4.64-1.17a16.67 16.67 0 0 1 8.13 2.34L454 462.83a11.62 11.62 0 0 0 3.48 1.17a5 5 0 0 0 4.65-4.66a14.27 14.27 0 0 0-.77-3.86c-.41-1.46-5-16-7.36-25.27a18.94 18.94 0 0 1-.33-3.47a11.4 11.4 0 0 1 5-9.35",fill:"currentColor"},null,-1),oe=o("path",{"data-name":"XMLID 505 -7",d:"M246.13 178.51a24.47 24.47 0 0 1 0-48.94c12.77 0 24.38 11.65 24.38 24.47c1.16 12.82-10.45 24.47-24.38 24.47m-123.06 0A24.47 24.47 0 1 1 147.45 154a24.57 24.57 0 0 1-24.38 24.47M184.6 48C82.43 48 0 116.75 0 203c0 46.61 24.38 88.56 63.85 116.53C67.34 321.84 68 327 68 329a11.38 11.38 0 0 1-.66 4.49C63.85 345.14 59.4 364 59.21 365s-1.16 3.5-1.16 4.66a5.49 5.49 0 0 0 5.8 5.83a7.15 7.15 0 0 0 3.49-1.17L108 351c3.49-2.33 5.81-2.33 9.29-2.33a16.33 16.33 0 0 1 5.81 1.16c18.57 5.83 39.47 8.16 60.37 8.16h10.45a133.24 133.24 0 0 1-5.81-38.45c0-78.08 75.47-141 168.35-141h10.45C354.1 105.1 277.48 48 184.6 48",fill:"currentColor"},null,-1),ae=[ee,oe];var te=T({name:"LogoWechat",render:function(f,r){return l(),m("svg",$,ae)}});const re={__name:"createorder",async setup(N,{expose:f}){f();let r,e;const h=z(),{id:d,type:t}=h.query,{data:_,pending:u,error:x}=([r,e]=I(()=>R(d,t)),r=await r,e(),r),C={media:"\u56FE\u6587",audio:"\u97F3\u9891",column:"\u4E13\u680F",book:"\u7535\u5B50\u4E66",video:"\u89C6\u9891",course:"\u8BFE\u7A0B"},{data:w}=([r,e]=I(()=>U(d,t)),r=await r,e(),r),c=L(0),D=a=>{c.value=c.value==a.id?0:a.id},b=B(()=>{if(c.value==0)return 0;let a=w.value.rows.find(g=>g.id==c.value);return a?a.price:0}),A=B(()=>{let a=((_.value.price*1e3-b.value*1e3)/1e3).toFixed(2);return a<=0?0:a}),v=L(!1);async function M(){v.value=!0;let a={};t=="course"||t=="book"||t=="column"?(a={goods_id:_.value.id,type:t},c.value&&(a.user_coupon_id=c.value)):t=="flashsale"&&(a={flashsale_id:d});let{data:g,error:O}=await X(a,t);v.value=!1,!O.value&&W(`/pay?no=${g.value.no}`,{replace:!0})}const k={route:h,id:d,type:t,data:_,pending:u,error:x,t:C,couponData:w,user_coupon_id:c,chooseCoupon:D,coupon_price:b,price:A,loading:v,submit:M,NCard:F,NTag:J,NButton:S,NImage:K,NIcon:Q,NGrid:Y,NGridItem:Z,LogoWechat:te};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}},se=o("h4",null,"\u4EA7\u54C1\u4FE1\u606F",-1),ne={class:"flex mb-5"},ce={class:"flex flex-1 ml-4 flex-col"},le={class:"flex text-xl text-gray-600"},ie={key:0,class:"mt-auto"},de=o("h4",null,"\u4F18\u60E0\u5238",-1),_e={key:0,class:"mb-5 text-gray-400 text-sm"},ue=o("h4",null,"\u652F\u4ED8\u65B9\u5F0F",-1),me={class:"flex mb-5"},pe={class:"wxpay"},fe=o("b",null,"\u5FAE\u4FE1\u652F\u4ED8",-1),he={class:"flex items-center mb-5"},xe=o("small",{class:"text-red-400 mr-auto"},"\u8BF7\u572830\u5206\u949F\u5185\u5B8C\u6210\u652F\u4ED8",-1),ve={key:0},ge=i("\u4F18\u60E0\u5238\u5DF2\u62B5\u6263"),ye={class:"text-red-500"},Ne=i("\u5143\uFF0C"),Ce=i(" \u9700\u652F\u4ED8 "),we={class:"flex justify-end"},be=i("\u786E\u8BA4\u652F\u4ED8");function ke(N,f,r,e,h,d){const t=q,_=H;return l(),G(_,{pending:e.pending,error:e.error},{default:n(()=>[s(e.NCard,{class:"createorder",size:"medium"},{default:n(()=>[se,o("div",ne,[s(e.NImage,{src:e.data.cover,class:j(["flex flex-shrink-0 rounded",e.type=="book"?"w-[100px] h-[140px]":"w-[180px] h-[100px]"])},null,8,["src","class"]),o("div",ce,[o("h5",le,[i(p(e.data.title)+" ",1),s(t,{value:e.data.price,class:"ml-auto"},null,8,["value"])]),e.type=="course"?(l(),m("div",ie,[s(e.NTag,{size:"small",bordered:!1},{default:n(()=>[i(p(e.t[e.data.type]),1)]),_:1})])):y("",!0)])]),de,s(e.NGrid,{"x-gap":20,cols:4,class:"mb-3"},{default:n(()=>[(l(!0),m(P,null,E(e.couponData.rows,(u,x)=>(l(),G(e.NGridItem,{key:x},{default:n(()=>[s(e.NButton,{strong:"",secondary:"",type:e.user_coupon_id==u.id?"success":"tertiary",onClick:C=>e.chooseCoupon(u)},{default:n(()=>[i(" \uFFE5"+p(u.price)+" \u4F18\u60E0\u5238 ",1)]),_:2},1032,["type","onClick"])]),_:2},1024))),128))]),_:1}),e.couponData.count==0?(l(),m("div",_e," \u6682\u65E0\u4F18\u60E0\u5238 ")):y("",!0),ue,o("div",me,[o("span",pe,[s(e.NIcon,null,{default:n(()=>[s(e.LogoWechat)]),_:1}),fe])]),o("div",he,[xe,e.user_coupon_id?(l(),m("span",ve,[ge,o("b",ye,p(e.coupon_price),1),Ne])):y("",!0),Ce,s(t,{value:e.price},null,8,["value"])]),o("div",we,[s(e.NButton,{type:"primary",onClick:e.submit,loading:e.loading},{default:n(()=>[be]),_:1},8,["loading"])])]),_:1})]),_:1},8,["pending","error"])}var Ee=V(re,[["render",ke]]);export{Ee as default};
